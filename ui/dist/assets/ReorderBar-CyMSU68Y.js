import{E as J,Q as xe,a6 as Re,a7 as Se,u as W,a8 as ee,k as T,j as x,a9 as Ce,l as N,aa as te,d as se,p as Oe,o as w,c as _,G as $e,a as k,F as A,r as D,m as K,n as E,K as q,a4 as Q,N as re,ab as Z,t as F,_ as ne}from"./index-h4hE2hpV.js";import{c as Fe}from"./mouse-dKSBP7Cv.js";function Te(e){return Re()?(Se(e),!0):!1}function oe(e){return typeof e=="function"?e():W(e)}const Ie=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const Me=(e,s)=>(e=Math.ceil(e),s=Math.floor(s),Math.floor(Math.random()*(s-e+1))+e);function Ve(e){return ee()}function Le(e,s=!0,t){Ve()?J(e,t):s?e():xe(e)}const ae=Ie?window:void 0;function B(e){var s;const t=oe(e);return(s=t==null?void 0:t.$el)!=null?s:t}function Ae(){const e=x(!1),s=ee();return s&&J(()=>{e.value=!0},s),e}function De(e){const s=Ae();return T(()=>(s.value,!!e()))}function Be(e,s,t={}){const{window:n=ae,...r}=t;let o;const a=De(()=>n&&"ResizeObserver"in n),i=()=>{o&&(o.disconnect(),o=void 0)},h=T(()=>{const p=oe(e);return Array.isArray(p)?p.map(m=>B(m)):[B(p)]}),l=N(h,p=>{if(i(),a.value&&n){o=new ResizeObserver(s);for(const m of p)m&&o.observe(m,r)}},{immediate:!0,flush:"post"}),u=()=>{i(),l()};return Te(u),{isSupported:a,stop:u}}function We(e,s={width:0,height:0},t={}){const{window:n=ae,box:r="content-box"}=t,o=T(()=>{var p,m;return(m=(p=B(e))==null?void 0:p.namespaceURI)==null?void 0:m.includes("svg")}),a=x(s.width),i=x(s.height),{stop:h}=Be(e,([p])=>{const m=r==="border-box"?p.borderBoxSize:r==="content-box"?p.contentBoxSize:p.devicePixelContentBoxSize;if(n&&o.value){const y=B(e);if(y){const b=y.getBoundingClientRect();a.value=b.width,i.value=b.height}}else if(m){const y=Array.isArray(m)?m:[m];a.value=y.reduce((b,{inlineSize:R})=>b+R,0),i.value=y.reduce((b,{blockSize:R})=>b+R,0)}else a.value=p.contentRect.width,i.value=p.contentRect.height},t);Le(()=>{const p=B(e);p&&(a.value="offsetWidth"in p?p.offsetWidth:s.width,i.value="offsetHeight"in p?p.offsetHeight:s.height)});const l=N(()=>B(e),p=>{a.value=p?s.width:0,i.value=p?s.height:0});function u(){h(),l()}return{width:a,height:i,stop:u}}function mt(e,s){const{containerStyle:t,wrapperProps:n,scrollTo:r,calculateRange:o,currentList:a,containerRef:i}="itemHeight"in s?Ne(s,e):ze(s,e);return{list:a,scrollTo:r,containerProps:{ref:i,onScroll:()=>{o()},style:t},wrapperProps:n}}function ie(e){const s=x(null),t=We(s),n=x([]),r=Ce(e);return{state:x({start:0,end:10}),source:r,currentList:n,size:t,containerRef:s}}function le(e,s,t){return n=>{if(typeof t=="number")return Math.ceil(n/t);const{start:r=0}=e.value;let o=0,a=0;for(let i=r;i<s.value.length;i++){const h=t(i);if(o+=h,a=i,o>n)break}return a-r}}function ue(e,s){return t=>{if(typeof s=="number")return Math.floor(t/s)+1;let n=0,r=0;for(let o=0;o<e.value.length;o++){const a=s(o);if(n+=a,n>=t){r=o;break}}return r+1}}function ce(e,s,t,n,{containerRef:r,state:o,currentList:a,source:i}){return()=>{const h=r.value;if(h){const l=t(e==="vertical"?h.scrollTop:h.scrollLeft),u=n(e==="vertical"?h.clientHeight:h.clientWidth),p=l-s,m=l+u+s;o.value={start:p<0?0:p,end:m>i.value.length?i.value.length:m},a.value=i.value.slice(o.value.start,o.value.end).map((y,b)=>({data:y,index:b+o.value.start}))}}}function de(e,s){return t=>typeof e=="number"?t*e:s.value.slice(0,t).reduce((r,o,a)=>r+e(a),0)}function fe(e,s,t,n){N([e.width,e.height,s,t],()=>{n()})}function pe(e,s){return T(()=>typeof e=="number"?s.value.length*e:s.value.reduce((t,n,r)=>t+e(r),0))}const Ue={horizontal:"scrollLeft",vertical:"scrollTop"};function ve(e,s,t,n){return r=>{n.value&&(n.value[Ue[e]]=t(r),s())}}function ze(e,s){const t=ie(s),{state:n,source:r,currentList:o,size:a,containerRef:i}=t,h={overflowX:"auto"},{itemWidth:l,overscan:u=5}=e,p=le(n,r,l),m=ue(r,l),y=ce("horizontal",u,m,p,t),b=de(l,r),R=T(()=>b(n.value.start)),S=pe(l,r);fe(a,s,i,y);const M=ve("horizontal",y,b,i),C=T(()=>({style:{height:"100%",width:`${S.value-R.value}px`,marginLeft:`${R.value}px`,display:"flex"}}));return{scrollTo:M,calculateRange:y,wrapperProps:C,containerStyle:h,currentList:o,containerRef:i}}function Ne(e,s){const t=ie(s),{state:n,source:r,currentList:o,size:a,containerRef:i}=t,h={overflowY:"auto"},{itemHeight:l,overscan:u=5}=e,p=le(n,r,l),m=ue(r,l),y=ce("vertical",u,m,p,t),b=de(l,r),R=T(()=>b(n.value.start)),S=pe(l,r);fe(a,s,i,y);const M=ve("vertical",y,b,i),C=T(()=>({style:{width:"100%",height:`${S.value-R.value}px`,marginTop:`${R.value}px`}}));return{calculateRange:y,scrollTo:M,containerStyle:h,wrapperProps:C,currentList:o,containerRef:i}}const X=["<","<=",">",">=","==","!=",""];function Ee(e,s){return s.find(t=>he(e,t))}function he(e,s){return s.indexOf(e)!=-1}function Ge(e){let s=!1,t;switch(e[0]=="!"&&e[1]!="="&&(s=!0,e=e.slice(1)),e[0]){case">":t=e[1]=="="?">=":">";break;case"<":t=e[1]=="="?"<=":"<";break;case"=":t=e[1]=="="?"==":"";break;case"!":t=e[1]=="="?"!=":"";break;default:t=""}return{negative:s,operator:t}}function yt(e,s,t){switch(t){case"==":return e.reduce((n,r,o)=>(s==r&&n.push(o),n),[]);case"":case">":case">=":case"<":case"<=":return e.reduce((n,r,o)=>(he(s,r)&&n.push(o),n),[]);case"!=":return e.reduce((n,r,o)=>(r!=s&&n.push(o),n),[]);default:te(t)}}function wt(e,s,t){const n=+s;if(isNaN(n))return[];switch(t){case"":case"==":return e.reduce((r,o,a)=>(o==n&&r.push(a),r),[]);case">":return e.reduce((r,o,a)=>(o>n&&r.push(a),r),[]);case">=":return e.reduce((r,o,a)=>(o>=n&&r.push(a),r),[]);case"<":return e.reduce((r,o,a)=>(o<n&&r.push(a),r),[]);case"<=":return e.reduce((r,o,a)=>(o<=n&&r.push(a),r),[]);case"!=":return e.reduce((r,o,a)=>(o!=n&&r.push(a),r),[]);default:te(t)}}function He(e,s,t,n,r){return e.reduce((o,a)=>{const i=s[a](t,n,r);return{indexes:[...new Set(i.indexes.concat(o.indexes))],suggestions:o.suggestions.concat(i.suggestions.map(h=>`${h}:${a}`))}},{indexes:[],suggestions:[]})}const Pe={class:"search-block"},je={key:0,class:"adv-search-block bg3-alt"},Ke={class:"filter-block"},qe=["onClick"],Qe=["onUpdate:modelValue"],Ze=["value"],Xe=["onUpdate:modelValue"],Ye=["onUpdate:modelValue"],Je=["value"],et=["onClick"],tt={class:"search-bar"},st=["placeholder"],rt={class:"suggs-anchor"},nt={key:0,class:"suggs-block"},ot=["onClick"],at=se({__name:"SearchFilter",props:{filterFields:{},data:{},filterMap:{}},emits:["update"],setup(e,{emit:s}){const t=e,n=s,r=Oe(),o=x(!1),a=x(!1),i=x(new URLSearchParams(window.location.search).get("s")||""),h=x(),l=x([]),u=x(I(i.value)),p=t.filterFields.concat([""]),m=function(){const v=["This is a search bar","Comma is used as a separator, for exemple fire:type, ability:thick fat",'":" is used after a word to indicate a specific search field, for exemple fire:type will only give fire types',"the search isn't case sensitive, so Bunbasaur or bunbsaur is the same, if not then it's a bug",`Numerical fields may support prefix operators such as ${X.join(", ")}, for exemple >=80:power`,"the prefix ! is used to negate a search so !fire:type will give anything that is NOT fire"];return v[Me(0,v.length-1)]}();let y=0,b=0,R=0,S=0,M=!1,C=0,U;function I(v){return v.split(",").map(f=>f.trim()).map(f=>{const g=Ge(f);f=f.replace(g.operator,""),g.negative&&(f=f.replace("!",""));const d=f.split(":"),O=d[0];let $=d[1];return!t.filterMap[$]&&$&&($=Ee($,t.filterFields)),{input:O,operator:g,field:$}})}function ge(v){let c=[];return v.reduce((f,g)=>{let d;if(g.field?d=t.filterMap[g.field](f.data,g.input.toLowerCase(),g.operator.operator):d=He(t.filterFields,t.filterMap,f.data,g.input.toLowerCase(),g.operator.operator),g.operator.negative){const O=t.data.reduce(($,vt,j)=>(~d.indexes.indexOf(j)||$.push(j),$),[]);d.indexes=O}return v.length>1&&(c.length&&(d.indexes=d.indexes.map(O=>c[O])),c=d.indexes),{indexes:d.indexes,suggestions:d.suggestions,data:d.indexes.map(O=>t.data[O])}},{indexes:[],suggestions:[],data:t.data})}function me(v){return!(!i.value||v.length<=1)}function z(v){if(v){const c=v.target;R=c.selectionStart||0;const f=c.value.split(",");for(let g=0,d=0;g<f.length;g++){const O=f[g];if(d+=O.length+g,d>=R){S=g,M=O.split(":")[1]!==void 0;break}}}y&&clearTimeout(y),y=setTimeout(()=>{u.value=I(i.value);const c=u.value.length?ge(u.value):{suggestions:[],indexes:[...Array(t.data.length).keys()]},f=u.value[S],g=M?t.filterFields.map(d=>`${f.input}:${d}`):c.suggestions;l.value=me(g)?g.slice(0,8):[],n("update",c.indexes),ye(),y=0},150)}function ye(){a.value=!1,b&&clearTimeout(b),b=setTimeout(()=>{a.value=!0},500)}function V(){i.value=u.value.map(v=>{const c=v.operator.negative?"!":"",f=v.operator.operator||"",g=v.field?`:${v.field}`:"";return`${c}${f}${v.input}${g}`}).join(", "),P()}function we(v){u.value[S]=I(v)[0],V(),z(),h.value.focus(),a.value=!1}function H(v=!1){const c=t.filterFields.indexOf(u.value[S].field);~c?u.value[S].field=t.filterFields[c+(v?-1:1)]:u.value[S].field=t.filterFields[0]}function _e(v){const c=l.value.length;switch(v.key){case"ArrowDown":if(!c)return;C=++C%c,u.value[S]=I(l.value[C])[0],V();break;case"ArrowUp":if(!c)return;C=--C||c-1,u.value[S]=I(l.value[C])[0],V();break;case"ArrowLeft":U=i.value,u.value=I(i.value=""),z();break;case"ArrowRight":if(U==null)return;u.value=I(i.value=U),U=void 0,z();break;case"Tab":if(!c)return;H(),V(),v.preventDefault();break;case"Control":if(!c)return;H(!0),V();break;case"Enter":a.value=!1,z();break;default:U=void 0}}N(Fe("search-suggestion"),function(){a.value=!1});function be(v,c){u.value.push({operator:{negative:!1,operator:""},input:v+""})}function ke(){o.value=!o.value}function P(){const v=Q.currentRoute.value;Q.push({name:v.name,params:v.params,query:{v:r.chosenVersionName,s:i.value}})}N(u,P);function L(){V()}return(v,c)=>(w(),_("div",Pe,[o.value?(w(),_("div",je,[$e(v.$slots,"default",{},void 0,!0),k("div",Ke,[(w(!0),_(A,null,D(u.value,(f,g)=>(w(),_("div",{key:g,class:"filter-item"},[k("button",{onClick:d=>{f.operator.negative=!f.operator.negative,L()},style:re(f.operator.negative?"":"text-decoration: line-through;"),class:"filter-neg"},c[5]||(c[5]=[k("span",null," ! ",-1)]),12,qe),E(k("select",{"onUpdate:modelValue":d=>f.operator.operator=d,onChange:c[0]||(c[0]=d=>L()),class:"filter-op"},[(w(!0),_(A,null,D(W(X),d=>(w(),_("option",{key:d,value:d},F(d),9,Ze))),128))],40,Qe),[[Z,f.operator.operator]]),E(k("input",{type:"text",class:"filter-input","onUpdate:modelValue":d=>f.input=d,onInput:c[1]||(c[1]=d=>L())},null,40,Xe),[[q,f.input]]),E(k("select",{"onUpdate:modelValue":d=>f.field=d,onChange:c[2]||(c[2]=d=>L()),class:"filter-field"},[(w(!0),_(A,null,D(W(p),d=>(w(),_("option",{key:d,value:d},F(d),9,Je))),128))],40,Ye),[[Z,f.field]]),k("div",{onClick:d=>{u.value.splice(g,1),L()},class:"filter-cross"}," (x) ",8,et)]))),128)),k("div",{class:"filter-item",onClick:c[3]||(c[3]=f=>{be(""),L()})}," add + ")])])):K("",!0),k("div",tt,[E(k("input",{type:"text",class:"search-input",onInput:z,placeholder:W(m),"onUpdate:modelValue":c[4]||(c[4]=f=>i.value=f),ref_key:"searchInputRef",ref:h,onKeydown:_e},null,40,st),[[q,i.value]]),k("button",{class:"search-open-advanced",onClick:ke},"Adv. search")]),k("div",rt,[a.value?(w(),_("div",nt,[(w(!0),_(A,null,D(l.value,f=>(w(),_("div",{key:f,class:"search-suggestion no-select",onClick:g=>we(f)},F(f),9,ot))),128))])):K("",!0)])]))}}),_t=ne(at,[["__scopeId","data-v-e97089d0"]]),it={key:0,class:"reorder-bar"},lt=["onClick"],ut={key:1,class:"reorder-bar"},ct=["onClick"],dt={key:1},G="→",Y="↓",ft="↑",pt=se({__name:"ReorderBar",props:{reorderFields:{},data:{},reorderMap:{},fullFields:{}},emits:["update"],setup(e,{emit:s}){const t=e,n=s,r=t.reorderFields.map(i=>({status:x(G),field:i}));function o(){r.forEach(function(i){i.status.value=G})}function a(i){const h=r[i],l=t.reorderMap[h.field];if(!l)return;let u;h.status.value===G?(n("update",l(t.data)),o(),u=Y):h.status.value===Y?(n("update",l(t.data).reverse()),o(),u=ft):(n("update",[...Array(t.data.length).keys()]),u=G),h.status.value=u}return(i,h)=>t.fullFields?(w(),_("div",ut,[(w(!0),_(A,null,D(t.fullFields,(l,u)=>(w(),_("div",{key:u,class:"reorder-button-reordered",style:re(`width: ${l.width};`)},[~t.reorderFields.indexOf(l.field)?(w(),_("span",{key:0,onClick:p=>a(t.reorderFields.indexOf(l.field))},F(l.str?l.str:l.field)+" "+F(W(r)[t.reorderFields.indexOf(l.field)].status),9,ct)):(w(),_("span",dt,F(l.str?l.str:l.field),1))],4))),128))])):(w(),_("div",it,[h[0]||(h[0]=k("div",null," Interact to reorder ",-1)),(w(!0),_(A,null,D(t.reorderFields,(l,u)=>(w(),_("div",{key:u,class:"reorder-button"},[k("div",{onClick:p=>a(u)},F(l)+" "+F(W(r)[u].status),9,lt)]))),128))]))}}),bt=ne(pt,[["__scopeId","data-v-13073310"]]);export{bt as R,_t as S,wt as a,yt as f,mt as u};
